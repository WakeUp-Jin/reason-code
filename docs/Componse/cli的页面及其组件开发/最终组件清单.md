# æœ€ç»ˆç»„ä»¶æ¸…å•

> æ ¹æ®è®¨è®ºç¡®è®¤çš„æ‰€æœ‰åŠŸèƒ½å’Œç»„ä»¶æ¸…å•
>
> æ—¥æœŸï¼š2025-12-23
> æ¶æ„ï¼š**CLI ç›´æ¥è°ƒç”¨ï¼ˆå•è¿›ç¨‹ï¼‰** + **JSON æ–‡ä»¶æŒä¹…åŒ–**

---

## ğŸ—ï¸ æ ¸å¿ƒæ¶æ„ç¡®è®¤

### é€šä¿¡æ–¹å¼
âœ… **CLI ç›´æ¥è°ƒç”¨**ï¼ˆè¿›ç¨‹å†…ï¼Œå‡½æ•°è°ƒç”¨ + äº‹ä»¶æ€»çº¿ï¼‰
- å‚è€ƒæ–‡æ¡£ï¼š`/mydocs/é€šä¿¡æœºåˆ¶/01-å½“å‰æ–¹æ¡ˆ-CLIç›´æ¥è°ƒç”¨.md`
- æ— éœ€ WebSocket/HTTP/SSE
- äº‹ä»¶é©±åŠ¨ï¼ˆBusï¼‰å®æ—¶åé¦ˆ

### æŒä¹…åŒ–æ–¹å¼
âœ… **JSON æ–‡ä»¶å­˜å‚¨**
- Session æ•°æ® â†’ `~/.myapp/sessions/{sessionId}.json`
- Message å†å² â†’ `~/.myapp/messages/{sessionId}/`
- é…ç½®æ–‡ä»¶ â†’ `~/.myapp/config.json`
- ä¸»é¢˜æ–‡ä»¶ â†’ å†…ç½® 6 ä¸ªç²¾é€‰ä¸»é¢˜

### çŠ¶æ€ç®¡ç†
âœ… **Zustand**ï¼ˆæˆ– Jotaiï¼‰
- è½»é‡çº§çŠ¶æ€ç®¡ç†
- æ— éœ€å¤æ‚çš„ Solid.js Store
- ä¸ Inkï¼ˆReactï¼‰å®Œç¾é›†æˆ

---

## ä¸€ã€âœ… å¿…é¡»ä¿ç•™çš„ç»„ä»¶ï¼ˆMVP æ ¸å¿ƒï¼‰

### 1.1 Context Provider å±‚ï¼ˆ7ä¸ªï¼‰

| Provider | åŠŸèƒ½ | ä¼˜å…ˆçº§ |
|----------|------|--------|
| **ThemeProvider** | ä¸»é¢˜ç®¡ç†ï¼ˆ6ä¸ªä¸»é¢˜ï¼‰ | P0 |
| **StoreProvider** | çŠ¶æ€ç®¡ç†ï¼ˆZustandï¼‰ | P0 |
| **DialogProvider** | å¯¹è¯æ¡†å †æ ˆç®¡ç† | P0 |
| **ToastProvider** | Toast é€šçŸ¥ | P0 |
| **RouteProvider** | è·¯ç”±ï¼ˆHome/Sessionï¼‰ | P0 |
| **AgentProvider** | Agent é…ç½®ç®¡ç† | P0 |
| **CommandProvider** | å‘½ä»¤é¢æ¿ | P0 |

### 1.2 æ ¸å¿ƒ UI ç»„ä»¶ï¼ˆ9ä¸ªï¼‰

| ç»„ä»¶ | æ–‡ä»¶ | è¯´æ˜ |
|------|------|------|
| **Dialog** | `ui/dialog.tsx` | å¯¹è¯æ¡†åŸºç¡€ |
| **DialogSelect** | `ui/dialog-select.tsx` | æ¨¡ç³Šæœç´¢é€‰æ‹©ï¼ˆæœ€æ ¸å¿ƒï¼‰ |
| **DialogConfirm** | `ui/dialog-confirm.tsx` | ç¡®è®¤å¯¹è¯æ¡† |
| **DialogPrompt** | `ui/dialog-prompt.tsx` | æ–‡æœ¬è¾“å…¥å¯¹è¯æ¡† |
| **Toast** | `ui/toast.tsx` | é€šçŸ¥æç¤º |
| **Prompt** | `components/prompt/index.tsx` | ç”¨æˆ·è¾“å…¥æ¡† |
| **PromptHistory** | `components/prompt/history.tsx` | å†å²è®°å½•ï¼ˆä¸Šä¸‹é”®ï¼‰ |
| **Logo** | `components/logo.tsx` | Logo æ˜¾ç¤º |
| **Border** | `components/border.tsx` | è¾¹æ¡†æ ·å¼ |

### 1.3 å¸ƒå±€ç»„ä»¶ï¼ˆ6ä¸ªï¼‰

| ç»„ä»¶ | æ–‡ä»¶ | è¯´æ˜ |
|------|------|------|
| **App** | `routes/app.tsx` | æ ¹ç»„ä»¶ |
| **Home** | `routes/home.tsx` | ä¸»é¡µï¼ˆLogo + è¾“å…¥ï¼‰ |
| **Session** | `routes/session/index.tsx` | ä¼šè¯ä¸»ç•Œé¢ |
| **Header** | `routes/session/header.tsx` | é¡¶éƒ¨æ ‡é¢˜æ  |
| **Footer** | `routes/session/footer.tsx` | åº•éƒ¨çŠ¶æ€æ  |
| **Sidebar** | `routes/session/sidebar.tsx` | ä¾§è¾¹æ ï¼ˆæ–‡ä»¶æµè§ˆï¼‰ |

### 1.4 ä¸šåŠ¡å¯¹è¯æ¡†ï¼ˆ6ä¸ªï¼‰

| ç»„ä»¶ | åŠŸèƒ½ | è¯´æ˜ |
|------|------|------|
| **DialogCommand** | å‘½ä»¤é¢æ¿ | æ¨¡ç³Šæœç´¢æ‰€æœ‰å‘½ä»¤ |
| **DialogStatus** | ç³»ç»ŸçŠ¶æ€ | æŸ¥çœ‹æœåŠ¡çŠ¶æ€ |
| **DialogModel** | æ¨¡å‹é€‰æ‹© | Agent æ ¸å¿ƒåŠŸèƒ½ |
| **DialogAgent** | Agent é€‰æ‹© | Agent æ ¸å¿ƒåŠŸèƒ½ |
| **DialogProvider** | Provider é…ç½® | API Key ç®¡ç† |
| **DialogTheme** | ä¸»é¢˜é€‰æ‹© | åˆ‡æ¢ä¸»é¢˜ |

### 1.5 Session ä¸“ç”¨å¯¹è¯æ¡†ï¼ˆ5ä¸ªï¼‰

| ç»„ä»¶ | åŠŸèƒ½ | è¯´æ˜ |
|------|------|------|
| **DialogSessionList** | ä¼šè¯åˆ—è¡¨ | åˆ‡æ¢ä¼šè¯ |
| **DialogSessionRename** | ä¼šè¯é‡å‘½å | ä¿®æ”¹ä¼šè¯å |
| **DialogMessage** | æ¶ˆæ¯è¯¦æƒ… | æŸ¥çœ‹å•æ¡æ¶ˆæ¯ |
| **DialogTimeline** | æ—¶é—´çº¿ | æ¶ˆæ¯å†å²è§†å›¾ |
| **DialogFork** | åˆ†æ”¯å¯¹è¯ | ä»å†å²åˆ†æ”¯ |

---

## äºŒã€âœ… ä¿ç•™çš„é«˜çº§åŠŸèƒ½

### 2.1 ä»£ç ç›¸å…³

| ç»„ä»¶/åŠŸèƒ½ | è¯´æ˜ | ä¼˜å…ˆçº§ |
|----------|------|--------|
| **ä»£ç é«˜äº®** | Syntax highlighting | P1 âœ… |
| **Diff æ˜¾ç¤º** | ä»£ç å·®å¼‚å¯¹æ¯” | P1 âœ… |
| **Markdown æ¸²æŸ“** | å¯Œæ–‡æœ¬æ˜¾ç¤º | P0 |

### 2.2 ç³»ç»Ÿé›†æˆ

| åŠŸèƒ½ | è¯´æ˜ | ä¼˜å…ˆçº§ |
|------|------|--------|
| **å‰ªè´´æ¿æ”¯æŒ** | clipboard.tsï¼ˆOSC52ï¼‰ | P2 âœ… |
| **å¤–éƒ¨ç¼–è¾‘å™¨** | editor.tsï¼ˆ$EDITORï¼‰ | P2 âœ… |
| **ç»ˆç«¯æ£€æµ‹** | é¢œè‰²è‡ªåŠ¨æ£€æµ‹ | P1 âœ… |

### 2.3 Agent åŠŸèƒ½

| åŠŸèƒ½ | è¯´æ˜ | ä¼˜å…ˆçº§ |
|------|------|--------|
| **TODO åˆ—è¡¨** | ä»»åŠ¡æ˜¾ç¤ºå’Œç®¡ç† | P1 âœ… |
| **Permission ç¡®è®¤** | æƒé™è¯·æ±‚ç¡®è®¤ | P1 âœ… |
| **Tool è°ƒç”¨** | å·¥å…·æ‰§è¡Œæ˜¾ç¤º | P0 |
| **Reasoning æ˜¾ç¤º** | æ€è€ƒè¿‡ç¨‹ | P2 |

---

## ä¸‰ã€âš ï¸ ç®€åŒ–/å»é™¤çš„åŠŸèƒ½

### 3.1 å»é™¤çš„ç»„ä»¶

| ç»„ä»¶ | åŸå›  |
|------|------|
| âŒ DialogAlert | ç”¨ Toast æ›¿ä»£ |
| âŒ DialogHelp | ç”¨ç®€å•çš„æ–‡æœ¬æ›¿ä»£ |
| âŒ DialogTag | éæ ¸å¿ƒåŠŸèƒ½ |
| âŒ DialogMcp | æš‚ä¸æ¥å…¥ MCP |
| âŒ DialogSubagent | ç®€åŒ–ç‰ˆæœ¬ä¸éœ€è¦ |
| âŒ Autocomplete | å»é™¤è‡ªåŠ¨è¡¥å…¨ |
| âŒ ExitProvider | ç®€åŒ–å¤„ç† |
| âŒ ArgsProvider | ç›´æ¥ä¼ å‚ |
| âŒ KVProvider | åˆå¹¶åˆ° LocalProvider |
| âŒ PromptRefProvider | å¤ªç»†ç²’åº¦ |

### 3.2 å»é™¤çš„å¤–éƒ¨é›†æˆ

| åŠŸèƒ½ | åŸå›  |
|------|------|
| âŒ LSP æ”¯æŒ | ä¸éœ€è¦ |
| âŒ MCP æ”¯æŒ | æš‚ä¸æ¥å…¥ |
| âŒ Formatter æ”¯æŒ | ä¸éœ€è¦ |
| âŒ VCS é›†æˆ | ä¸éœ€è¦ |
| âŒ WebSocket | ç”¨ç›´æ¥è°ƒç”¨ |
| âŒ HTTP/SSE | ç”¨ç›´æ¥è°ƒç”¨ |

---

## å››ã€ğŸ¨ ä¸»é¢˜ç³»ç»Ÿ

### 4.1 ç²¾é€‰ 6 ä¸ªä¸»é¢˜

| ä¸»é¢˜ | ç‰¹ç‚¹ | ä¸»è‰²è°ƒ |
|------|------|--------|
| **kanagawa** â­ | æ—¥å¼ä¼˜é›… | è“ç´«è‰²ï¼ˆ#7E9CD8ï¼‰ |
| **github** | çº¯ç™½/é»‘èƒŒæ™¯ | è“è‰²ï¼ˆ#58a6ffï¼‰ |
| **solarized** | ç»å…¸é»„è‰² | è“è‰² + é»„è‰²ï¼ˆ#b58900ï¼‰ |
| **dracula** | æ·±ç´«æŠ¤çœ¼ | ç´«è‰²ï¼ˆ#bd93f9ï¼‰ |
| **nord** | å†°è“å†·è‰² | è“è‰²ï¼ˆ#88c0d0ï¼‰ |
| **catppuccin** | Mocha æš–è‰² | ç´«çº¢è‰²ï¼ˆ#cba6f7ï¼‰ |

### 4.2 ä¸»é¢˜åŠŸèƒ½

âœ… Dark/Light æ¨¡å¼åˆ‡æ¢
âœ… ç»ˆç«¯é¢œè‰²è‡ªåŠ¨æ£€æµ‹
âœ… è¿è¡Œæ—¶åŠ¨æ€åˆ‡æ¢
âœ… 28 ç§è¯­ä¹‰åŒ–é¢œè‰²

---

## äº”ã€ğŸ¬ æ ¸å¿ƒåŠŸèƒ½æ¸…å•

### 5.1 Session ç®¡ç†

| åŠŸèƒ½ | è¯´æ˜ |
|------|------|
| âœ… åˆ›å»ºä¼šè¯ | æ–°å»ºå¯¹è¯ |
| âœ… åˆ‡æ¢ä¼šè¯ | å¤šä¼šè¯ç®¡ç† |
| âœ… é‡å‘½åä¼šè¯ | ä¿®æ”¹æ ‡é¢˜ |
| âœ… åˆ é™¤ä¼šè¯ | æ¸…ç†ä¼šè¯ |
| âœ… ä¼šè¯åˆ†æ”¯ | ä»å†å²åˆ†æ”¯ |
| âœ… ä¼šè¯æŒä¹…åŒ– | JSON æ–‡ä»¶ä¿å­˜ |

### 5.2 æ¶ˆæ¯åŠŸèƒ½

| åŠŸèƒ½ | è¯´æ˜ |
|------|------|
| âœ… æ–‡æœ¬æ¶ˆæ¯ | æ™®é€šå¯¹è¯ |
| âœ… Markdown æ¸²æŸ“ | å¯Œæ–‡æœ¬æ˜¾ç¤º |
| âœ… ä»£ç é«˜äº® | Syntax highlighting â­ |
| âœ… Diff æ˜¾ç¤º | ä»£ç å·®å¼‚å¯¹æ¯” â­ |
| âœ… æµå¼è¾“å‡º | å®æ—¶æ˜¾ç¤º |
| âœ… æ¶ˆæ¯å†å² | æŸ¥çœ‹å†å² |
| âœ… æ¶ˆæ¯è¯¦æƒ… | æŸ¥çœ‹å•æ¡ |
| âœ… æ—¶é—´çº¿è§†å›¾ | å†å²æµè§ˆ |

### 5.3 Agent åŠŸèƒ½

| åŠŸèƒ½ | è¯´æ˜ |
|------|------|
| âœ… Agent é€‰æ‹© | åˆ‡æ¢ Agent |
| âœ… Model é€‰æ‹© | åˆ‡æ¢æ¨¡å‹ |
| âœ… Provider é…ç½® | API Key ç®¡ç† |
| âœ… Tool è°ƒç”¨æ˜¾ç¤º | å·¥å…·æ‰§è¡Œåé¦ˆ |
| âœ… TODO åˆ—è¡¨ | ä»»åŠ¡ç®¡ç† â­ |
| âœ… Permission ç¡®è®¤ | æƒé™è¯·æ±‚ â­ |
| âš ï¸ Reasoning æ˜¾ç¤º | æ€è€ƒè¿‡ç¨‹ï¼ˆå¯é€‰ï¼‰ |

### 5.4 äº¤äº’åŠŸèƒ½

| åŠŸèƒ½ | è¯´æ˜ |
|------|------|
| âœ… å‘½ä»¤é¢æ¿ | Ctrl+P å¿«é€Ÿå‘½ä»¤ |
| âœ… æ¨¡ç³Šæœç´¢ | fuzzysort |
| âœ… å†å²è®°å½• | ä¸Šä¸‹é”®ç¿»å†å² |
| âœ… å¿«æ·é”® | ç¡¬ç¼–ç æ ¸å¿ƒå‡ ä¸ª |
| âœ… çŠ¶æ€æŸ¥çœ‹ | ç³»ç»ŸçŠ¶æ€é¢æ¿ |
| âœ… Toast é€šçŸ¥ | æ“ä½œåé¦ˆ |
| âœ… å‰ªè´´æ¿ | OSC52 æ”¯æŒ â­ |
| âœ… å¤–éƒ¨ç¼–è¾‘å™¨ | $EDITOR é›†æˆ â­ |
| âŒ è‡ªåŠ¨è¡¥å…¨ | å»é™¤ |

---

## å…­ã€ğŸ”§ å·¥å…·ä¸è¾…åŠ©

### 6.1 ä¿ç•™çš„å·¥å…·

| å·¥å…· | æ–‡ä»¶ | è¯´æ˜ |
|------|------|------|
| âœ… terminal.ts | `util/terminal.ts` | ç»ˆç«¯é¢œè‰²æ£€æµ‹ â­ |
| âœ… clipboard.ts | `util/clipboard.ts` | å‰ªè´´æ¿æ“ä½œ â­ |
| âœ… editor.ts | `util/editor.ts` | å¤–éƒ¨ç¼–è¾‘å™¨ â­ |
| âš ï¸ spinner.ts | `util/spinner.ts` | åŠ è½½åŠ¨ç”»ï¼ˆå¯é€‰ï¼‰ |

### 6.2 æ•°æ®å¤„ç†

| åŠŸèƒ½ | è¯´æ˜ |
|------|------|
| âœ… äº‹ä»¶æ€»çº¿ | Bus ç³»ç»Ÿ |
| âœ… JSON åºåˆ—åŒ– | æŒä¹…åŒ– |
| âœ… æ¨¡ç³Šæœç´¢ | fuzzysort |
| âœ… çŠ¶æ€ç®¡ç† | Zustand |
| âœ… Diff è§£æ | parsePatch |
| âœ… ä»£ç é«˜äº® | Syntax parsers |

---

## ä¸ƒã€ğŸ“Š æ•°æ®æ¨¡å‹

### 7.1 æ ¸å¿ƒæ•°æ®ç±»å‹

```typescript
// Session
interface Session {
  id: string
  title: string
  agentId: string
  modelId: string
  createdAt: number
  updatedAt: number
}

// Message
interface Message {
  id: string
  sessionId: string
  role: 'user' | 'assistant'
  content: string
  parts: Part[]
  timestamp: number
}

// Part
type Part = TextPart | ToolPart | ReasoningPart

interface TextPart {
  type: 'text'
  text: string
  delta?: string  // æµå¼è¾“å‡ºå¢é‡
}

interface ToolPart {
  type: 'tool'
  tool: string
  input: any
  output?: any
  status: 'pending' | 'running' | 'success' | 'error'
}

interface ReasoningPart {
  type: 'reasoning'
  text: string
  delta?: string
}

// Todo
interface Todo {
  id: string
  sessionId: string
  content: string
  status: 'pending' | 'in_progress' | 'completed'
  activeForm: string  // è¿›è¡Œä¸­çš„æè¿°
}

// Permission
interface Permission {
  id: string
  sessionId: string
  type: 'tool' | 'file' | 'network'
  description: string
  approved?: boolean
}

// Agent
interface Agent {
  id: string
  name: string
  description: string
  color: string
}

// Config
interface Config {
  theme: string
  mode: 'dark' | 'light'
  currentAgent: string
  currentModel: string
  providers: Record<string, { apiKey: string }>
}
```

---

## å…«ã€ğŸ—‚ï¸ æ–‡ä»¶ç»“æ„

```
src/
â”œâ”€â”€ cli/
â”‚   â””â”€â”€ main.ts                      # CLI å…¥å£
â”‚
â”œâ”€â”€ ui/                              # UI ç»„ä»¶å±‚
â”‚   â”œâ”€â”€ dialog.tsx                   # å¯¹è¯æ¡†åŸºç¡€
â”‚   â”œâ”€â”€ dialog-select.tsx            # é€‰æ‹©å¯¹è¯æ¡† â­
â”‚   â”œâ”€â”€ dialog-confirm.tsx           # ç¡®è®¤å¯¹è¯æ¡†
â”‚   â”œâ”€â”€ dialog-prompt.tsx            # è¾“å…¥å¯¹è¯æ¡†
â”‚   â””â”€â”€ toast.tsx                    # é€šçŸ¥ç»„ä»¶
â”‚
â”œâ”€â”€ components/                      # ä¸šåŠ¡ç»„ä»¶
â”‚   â”œâ”€â”€ prompt/
â”‚   â”‚   â”œâ”€â”€ index.tsx               # è¾“å…¥æ¡†
â”‚   â”‚   â””â”€â”€ history.tsx             # å†å²è®°å½•
â”‚   â”œâ”€â”€ dialog-command.tsx          # å‘½ä»¤é¢æ¿
â”‚   â”œâ”€â”€ dialog-status.tsx           # çŠ¶æ€æŸ¥çœ‹
â”‚   â”œâ”€â”€ dialog-model.tsx            # æ¨¡å‹é€‰æ‹©
â”‚   â”œâ”€â”€ dialog-agent.tsx            # Agent é€‰æ‹©
â”‚   â”œâ”€â”€ dialog-provider.tsx         # Provider é…ç½®
â”‚   â”œâ”€â”€ dialog-theme.tsx            # ä¸»é¢˜é€‰æ‹©
â”‚   â”œâ”€â”€ dialog-session-list.tsx     # ä¼šè¯åˆ—è¡¨
â”‚   â”œâ”€â”€ dialog-session-rename.tsx   # ä¼šè¯é‡å‘½å
â”‚   â”œâ”€â”€ dialog-message.tsx          # æ¶ˆæ¯è¯¦æƒ…
â”‚   â”œâ”€â”€ dialog-timeline.tsx         # æ—¶é—´çº¿
â”‚   â”œâ”€â”€ dialog-fork.tsx             # åˆ†æ”¯å¯¹è¯
â”‚   â”œâ”€â”€ todo-list.tsx               # TODO åˆ—è¡¨æ˜¾ç¤º â­
â”‚   â”œâ”€â”€ permission-prompt.tsx       # Permission ç¡®è®¤ â­
â”‚   â”œâ”€â”€ code-block.tsx              # ä»£ç å—ï¼ˆé«˜äº®ï¼‰â­
â”‚   â”œâ”€â”€ diff-view.tsx               # Diff æ˜¾ç¤º â­
â”‚   â”œâ”€â”€ logo.tsx                    # Logo
â”‚   â””â”€â”€ border.tsx                  # è¾¹æ¡†
â”‚
â”œâ”€â”€ routes/                          # è·¯ç”±é¡µé¢
â”‚   â”œâ”€â”€ app.tsx                     # æ ¹ç»„ä»¶
â”‚   â”œâ”€â”€ home.tsx                    # ä¸»é¡µ
â”‚   â””â”€â”€ session/
â”‚       â”œâ”€â”€ index.tsx               # ä¼šè¯ä¸»é¡µ
â”‚       â”œâ”€â”€ header.tsx              # å¤´éƒ¨
â”‚       â”œâ”€â”€ footer.tsx              # åº•éƒ¨
â”‚       â””â”€â”€ sidebar.tsx             # ä¾§è¾¹æ 
â”‚
â”œâ”€â”€ contexts/                        # Context Providers
â”‚   â”œâ”€â”€ theme.tsx                   # ä¸»é¢˜ç®¡ç†
â”‚   â”œâ”€â”€ store.tsx                   # çŠ¶æ€ç®¡ç†ï¼ˆZustandï¼‰
â”‚   â”œâ”€â”€ dialog.tsx                  # å¯¹è¯æ¡†ç®¡ç†
â”‚   â”œâ”€â”€ toast.tsx                   # Toast ç®¡ç†
â”‚   â”œâ”€â”€ route.tsx                   # è·¯ç”±ç®¡ç†
â”‚   â”œâ”€â”€ agent.tsx                   # Agent ç®¡ç†
â”‚   â””â”€â”€ command.tsx                 # å‘½ä»¤é¢æ¿
â”‚
â”œâ”€â”€ agent/                           # Agent å±‚
â”‚   â”œâ”€â”€ index.ts                    # Agent å…¥å£
â”‚   â”œâ”€â”€ chat.ts                     # å¯¹è¯é€»è¾‘
â”‚   â”œâ”€â”€ tools.ts                    # Tool å®šä¹‰
â”‚   â””â”€â”€ stream.ts                   # æµå¼å¤„ç†
â”‚
â”œâ”€â”€ storage/                         # æŒä¹…åŒ–å±‚
â”‚   â”œâ”€â”€ index.ts                    # å­˜å‚¨æ¥å£
â”‚   â”œâ”€â”€ session.ts                  # Session å­˜å‚¨
â”‚   â”œâ”€â”€ message.ts                  # Message å­˜å‚¨
â”‚   â”œâ”€â”€ todo.ts                     # TODO å­˜å‚¨ â­
â”‚   â”œâ”€â”€ permission.ts               # Permission å­˜å‚¨ â­
â”‚   â””â”€â”€ config.ts                   # é…ç½®å­˜å‚¨
â”‚
â”œâ”€â”€ bus/                             # äº‹ä»¶æ€»çº¿
â”‚   â””â”€â”€ index.ts                    # Bus å®ç°
â”‚
â”œâ”€â”€ themes/                          # ä¸»é¢˜æ–‡ä»¶
â”‚   â”œâ”€â”€ kanagawa.json               # Kanagawa ä¸»é¢˜
â”‚   â”œâ”€â”€ github.json                 # GitHub ä¸»é¢˜
â”‚   â”œâ”€â”€ solarized.json              # Solarized ä¸»é¢˜
â”‚   â”œâ”€â”€ dracula.json                # Dracula ä¸»é¢˜
â”‚   â”œâ”€â”€ nord.json                   # Nord ä¸»é¢˜
â”‚   â””â”€â”€ catppuccin.json             # Catppuccin ä¸»é¢˜
â”‚
â””â”€â”€ utils/                           # å·¥å…·å‡½æ•°
    â”œâ”€â”€ terminal.ts                 # ç»ˆç«¯å·¥å…· â­
    â”œâ”€â”€ clipboard.ts                # å‰ªè´´æ¿ â­
    â”œâ”€â”€ editor.ts                   # å¤–éƒ¨ç¼–è¾‘å™¨ â­
    â”œâ”€â”€ diff.ts                     # Diff è§£æ â­
    â””â”€â”€ highlight.ts                # ä»£ç é«˜äº® â­
```

---

## ä¹ã€ğŸ¯ å¼€å‘ä¼˜å…ˆçº§

### Phase 1: åŸºç¡€æ¶æ„ï¼ˆ1-2å¤©ï¼‰
1. âœ… é¡¹ç›®åˆå§‹åŒ–ï¼ˆBun + Ink + TypeScriptï¼‰
2. âœ… åŸºç¡€ Context Providers
3. âœ… è·¯ç”±ç³»ç»Ÿï¼ˆHome + Sessionï¼‰
4. âœ… ä¸»é¢˜ç³»ç»Ÿï¼ˆ6 ä¸ªä¸»é¢˜ï¼‰
5. âœ… JSON æŒä¹…åŒ–

### Phase 2: æ ¸å¿ƒ UIï¼ˆ2-3å¤©ï¼‰
1. âœ… DialogSelectï¼ˆæœ€æ ¸å¿ƒï¼‰
2. âœ… Prompt è¾“å…¥æ¡†
3. âœ… Toast é€šçŸ¥
4. âœ… å¸ƒå±€ç»„ä»¶ï¼ˆHeader/Footer/Sidebarï¼‰
5. âœ… Logo + Border

### Phase 3: ä¸šåŠ¡å¯¹è¯æ¡†ï¼ˆ2-3å¤©ï¼‰
1. âœ… DialogCommandï¼ˆå‘½ä»¤é¢æ¿ï¼‰
2. âœ… DialogStatus
3. âœ… DialogModel
4. âœ… DialogAgent
5. âœ… DialogProvider
6. âœ… DialogTheme

### Phase 4: Session åŠŸèƒ½ï¼ˆ3-4å¤©ï¼‰
1. âœ… Session ç®¡ç†
2. âœ… Message æ˜¾ç¤º
3. âœ… ä»£ç é«˜äº® â­
4. âœ… Diff æ˜¾ç¤º â­
5. âœ… å†å²è®°å½•
6. âœ… Session å¯¹è¯æ¡†ï¼ˆList/Rename/Forkï¼‰
7. âœ… æ—¶é—´çº¿/æ¶ˆæ¯è¯¦æƒ…

### Phase 5: Agent é›†æˆï¼ˆ3-4å¤©ï¼‰
1. âœ… Agent ç›´æ¥è°ƒç”¨
2. âœ… äº‹ä»¶æ€»çº¿ï¼ˆBusï¼‰
3. âœ… æµå¼è¾“å‡º
4. âœ… Tool è°ƒç”¨æ˜¾ç¤º
5. âœ… TODO åˆ—è¡¨ â­
6. âœ… Permission ç¡®è®¤ â­
7. âœ… é”™è¯¯å¤„ç†

### Phase 6: ç³»ç»Ÿé›†æˆï¼ˆ2å¤©ï¼‰
1. âœ… å‰ªè´´æ¿æ”¯æŒ â­
2. âœ… å¤–éƒ¨ç¼–è¾‘å™¨ â­
3. âœ… ç»ˆç«¯æ£€æµ‹ â­
4. âœ… å¿«æ·é”®ç³»ç»Ÿ

### Phase 7: ä¼˜åŒ–ä¸æµ‹è¯•ï¼ˆ2å¤©ï¼‰
1. âœ… æ€§èƒ½ä¼˜åŒ–
2. âœ… Bug ä¿®å¤
3. âœ… æ–‡æ¡£å®Œå–„
4. âœ… å‘å¸ƒå‡†å¤‡

**æ€»è®¡ï¼š15-20 å¤©å®Œæˆå®Œæ•´ç‰ˆ**

---

## åã€ğŸš€ æŠ€æœ¯æ ˆ

### æ ¸å¿ƒä¾èµ–
```json
{
  "dependencies": {
    "ink": "^4.4.1",
    "react": "^18.2.0",
    "zustand": "^4.4.7",
    "fuzzysort": "^3.1.0",
    "chalk": "^5.3.0",
    "diff": "^5.1.0",
    "highlight.js": "^11.9.0"
  },
  "devDependencies": {
    "bun": "^1.0.0",
    "@types/react": "^18.2.0",
    "@types/diff": "^5.0.9",
    "typescript": "^5.3.0"
  }
}
```

### å¯é€‰ä¾èµ–
```json
{
  "optionalDependencies": {
    "ink-text-input": "^5.0.1",
    "ink-select-input": "^5.0.0",
    "ink-spinner": "^5.0.0"
  }
}
```

---

## åä¸€ã€ğŸ“ æ³¨æ„äº‹é¡¹

### 11.1 æ¶æ„åŸåˆ™
1. âœ… **åŠŸèƒ½å®Œæ•´**ï¼šåŒ…å«æ‰€æœ‰å¿…è¦åŠŸèƒ½
2. âœ… **ä½è€¦åˆ**ï¼šç»„ä»¶ç‹¬ç«‹ï¼Œæ˜“äºæ›¿æ¢
3. âœ… **å¯æ‰©å±•**ï¼šé¢„ç•™æ¥å£ï¼Œæœªæ¥å¯å‡çº§
4. âœ… **ç”¨æˆ·ä½“éªŒ**ï¼šæµç•…ã€å¿«é€Ÿã€ç¾è§‚

### 11.2 ä»£ç è§„èŒƒ
1. âœ… ä½¿ç”¨ TypeScript ä¸¥æ ¼æ¨¡å¼
2. âœ… å‡½æ•°å¼ç»„ä»¶ä¼˜å…ˆ
3. âœ… ç»Ÿä¸€å‘½åè§„èŒƒï¼ˆPascalCase ç»„ä»¶ï¼ŒcamelCase å‡½æ•°ï¼‰
4. âœ… å……åˆ†çš„ç±»å‹å®šä¹‰
5. âœ… ç®€æ´çš„æ³¨é‡Š

### 11.3 æ€§èƒ½è¦æ±‚
1. âœ… å¯åŠ¨æ—¶é—´ < 100ms
2. âœ… å†…å­˜å ç”¨ < 150MB
3. âœ… äº‹ä»¶å»¶è¿Ÿ < 5ms
4. âœ… UI æ¸²æŸ“ 60fps

---

## åäºŒã€âœ… å·²ç¡®è®¤æ¸…å•

### é€šä¿¡æœºåˆ¶
- âœ… CLI ç›´æ¥è°ƒç”¨ï¼ˆå•è¿›ç¨‹ï¼‰
- âœ… äº‹ä»¶æ€»çº¿ï¼ˆBusï¼‰
- âœ… æ— éœ€ WebSocket/HTTP

### æŒä¹…åŒ–
- âœ… JSON æ–‡ä»¶å­˜å‚¨
- âœ… å†å²è®°å½•ä¿ç•™

### Session
- âœ… å…¨éƒ¨åŠŸèƒ½ä¿ç•™
- âœ… åˆ—è¡¨/é‡å‘½å/åˆ†æ”¯/æ¶ˆæ¯/æ—¶é—´çº¿

### è¾“å…¥åŠŸèƒ½
- âœ… å†å²è®°å½•ï¼ˆä¸Šä¸‹é”®ï¼‰
- âŒ è‡ªåŠ¨è¡¥å…¨ï¼ˆå»é™¤ï¼‰

### å¯¹è¯æ¡†
- âœ… confirm + promptï¼ˆ2ä¸ªåŸºç¡€å¯¹è¯æ¡†ï¼‰
- âœ… selectï¼ˆæ ¸å¿ƒï¼‰
- âŒ alertï¼ˆç”¨ Toast æ›¿ä»£ï¼‰

### ä»£ç ç›¸å…³
- âœ… ä»£ç é«˜äº® â­
- âœ… Diff æ˜¾ç¤º â­
- âœ… Markdown æ¸²æŸ“

### Agent åŠŸèƒ½
- âœ… TODO åˆ—è¡¨ â­
- âœ… Permission ç¡®è®¤ â­
- âœ… Tool è°ƒç”¨æ˜¾ç¤º

### ç³»ç»Ÿé›†æˆ
- âœ… å‰ªè´´æ¿ï¼ˆclipboard.tsï¼‰â­
- âœ… å¤–éƒ¨ç¼–è¾‘å™¨ï¼ˆeditor.tsï¼‰â­
- âœ… ç»ˆç«¯æ£€æµ‹ â­
- âŒ MCP/LSP/Formatter/VCSï¼ˆå»é™¤ï¼‰

### å¿«æ·é”®
- âœ… ç®€åŒ–ç‰ˆï¼ˆç¡¬ç¼–ç æ ¸å¿ƒå¿«æ·é”®ï¼‰

### ä¸»é¢˜
- âœ… 6 ä¸ªç²¾é€‰ä¸»é¢˜
- âœ… kanagawaï¼ˆä½ é€‰çš„ï¼‰
- âœ… githubï¼ˆç™½è‰²ä¸»é¢˜ï¼‰
- âœ… solarizedï¼ˆé»„è‰²ä¸»é¢˜ï¼‰
- âœ… dracula + nord + catppuccin

---

## ğŸ“ åç»­å·¥ä½œ

1. âœ… åˆ›å»ºæ¶æ„è®¾è®¡æ–‡æ¡£
2. âœ… åˆ›å»ºæ•°æ®æµæ–‡æ¡£
3. âœ… åˆ›å»º UI ç»„ä»¶å®ç°æŒ‡å—
4. âœ… åˆ›å»ºä¸»é¢˜ç³»ç»Ÿæ–‡æ¡£
5. âœ… å¼€å§‹ç¼–ç å®ç°

---

**æœ€åæ›´æ–°**ï¼š2025-12-23
**çŠ¶æ€**ï¼šâœ… å·²ç¡®è®¤ï¼Œå¯ä»¥å¼€å§‹åˆ›å»ºè¯¦ç»†æ–‡æ¡£
**é¢„è®¡å·¥æœŸ**ï¼š15-20 å¤©å®Œæˆå®Œæ•´ç‰ˆ
