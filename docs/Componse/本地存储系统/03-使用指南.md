# ä½¿ç”¨æŒ‡å—

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒé…ç½®

**1. å®‰è£…ä¾èµ–**

```bash
cd packages/cli
bun install
```

**2. é…ç½®ç¯å¢ƒå˜é‡**

åˆ›å»º `.env` æ–‡ä»¶ï¼š

```bash
# AI Provider API Keys
ANTHROPIC_API_KEY=sk-ant-xxx
OPENAI_API_KEY=sk-xxx
GOOGLE_API_KEY=AIzaSy-xxx

# å¯é€‰ï¼šè‡ªå®šä¹‰ endpoint
# ANTHROPIC_BASE_URL=https://api.anthropic.com
# OPENAI_BASE_URL=https://api.openai.com/v1
```

**3. è¿è¡Œåº”ç”¨**

```bash
bun run dev
```

## ğŸ“ åŸºæœ¬ä½¿ç”¨

### 1. é¦–æ¬¡å¯åŠ¨

åº”ç”¨é¦–æ¬¡å¯åŠ¨æ—¶ï¼š
- è‡ªåŠ¨åˆ›å»ºé…ç½®æ–‡ä»¶ `~/.reason-cli/config.json`
- è‡ªåŠ¨åˆ›å»ºä¼šè¯ç›®å½• `~/.reason-cli/sessions/`
- åˆ›å»ºç¬¬ä¸€ä¸ªä¼šè¯
- ä½¿ç”¨é»˜è®¤é…ç½®ï¼ˆKanagawa ä¸»é¢˜ï¼ŒDark æ¨¡å¼ï¼‰

### 2. å‘é€æ¶ˆæ¯

```bash
# è¾“å…¥æ¶ˆæ¯
> Hello, how are you?

# æ¶ˆæ¯è‡ªåŠ¨ä¿å­˜åˆ°å½“å‰ä¼šè¯
# æ–‡ä»¶ï¼š~/.reason-cli/sessions/{sessionId}.json
```

**è‡ªåŠ¨ä¿å­˜è§¦å‘ï¼š**
- âœ… ç”¨æˆ·æ¶ˆæ¯æ·»åŠ åç«‹å³ä¿å­˜
- âœ… AI å“åº”å®Œæˆåä¿å­˜

### 3. åˆ‡æ¢æ¨¡å‹

```bash
# æŒ‰ä¸‹å‘½ä»¤å¿«æ·é”®ï¼ˆå®ç°çš„å‘½ä»¤ç³»ç»Ÿï¼‰
Ctrl+P (æˆ–å…¶ä»–å¿«æ·é”®)

# é€‰æ‹©æ¨¡å‹
â¯ Anthropic
    â¯ Claude Sonnet 4 (current)   # å½“å‰ä½¿ç”¨ï¼ˆç»¿è‰²ï¼‰
      Claude 3 Opus
  OpenAI
      GPT-4o                       # å…‰æ ‡é€‰ä¸­ï¼ˆç´«è‰²ï¼‰
      GPT-3.5 Turbo
  Google
      Gemini Pro

# é€‰æ‹©åè‡ªåŠ¨ä¿å­˜é…ç½®
```

**ä¿å­˜å†…å®¹ï¼š**
```json
{
  "model": {
    "current": "gpt-4o"
  }
}
```

### 4. é‡å¯æ¢å¤

```bash
# å…³é—­åº”ç”¨
Ctrl+C

# é‡æ–°æ‰“å¼€
bun run dev

# è‡ªåŠ¨æ¢å¤ï¼š
# - ä¸Šæ¬¡ä½¿ç”¨çš„ä¼šè¯
# - ä¸Šæ¬¡é€‰æ‹©çš„æ¨¡å‹
# - ä¸Šæ¬¡çš„ä¸»é¢˜è®¾ç½®
# - æ‰€æœ‰å†å²æ¶ˆæ¯
```

## ğŸ¨ é…ç½®ç®¡ç†

### æŸ¥çœ‹å½“å‰é…ç½®

```bash
# æŸ¥çœ‹é…ç½®æ–‡ä»¶
cat ~/.reason-cli/config.json

# è¾“å‡ºç¤ºä¾‹ï¼š
{
  "model": {
    "current": "claude-sonnet-4",
    "fallback": "gpt-4o"
  },
  "providers": {
    "anthropic": {
      "apiKey": "${ANTHROPIC_API_KEY}",
      "baseUrl": "https://api.anthropic.com",
      "timeout": 60000
    }
  },
  "ui": {
    "theme": "kanagawa",
    "mode": "dark"
  },
  "session": {
    "lastSessionId": "1703635200000-abc1234",
    "autoSave": true,
    "saveDebounce": 500
  }
}
```

### æ‰‹åŠ¨ä¿®æ”¹é…ç½®

**âš ï¸ æ³¨æ„ï¼šåº”ç”¨è¿è¡Œæ—¶ä¿®æ”¹é…ç½®ä¸ä¼šç«‹å³ç”Ÿæ•ˆï¼Œéœ€è¦é‡å¯åº”ç”¨ã€‚**

```bash
# 1. å…³é—­åº”ç”¨
Ctrl+C

# 2. ç¼–è¾‘é…ç½®
vi ~/.reason-cli/config.json

# 3. é‡å¯åº”ç”¨
bun run dev
```

### é…ç½®é¡¹è¯´æ˜

#### model é…ç½®

```json
{
  "model": {
    "current": "claude-sonnet-4",  // å½“å‰ä½¿ç”¨çš„æ¨¡å‹ ID
    "fallback": "gpt-4o"            // å¤‡ç”¨æ¨¡å‹ï¼ˆæœªæ¥åŠŸèƒ½ï¼‰
  }
}
```

**å¯ç”¨æ¨¡å‹ IDï¼š**
- `claude-sonnet-4` - Claude Sonnet 4 (Anthropic)
- `gpt-4o` - GPT-4o (OpenAI)
- `gemini-pro` - Gemini Pro (Google)

#### providers é…ç½®

```json
{
  "providers": {
    "anthropic": {
      "apiKey": "${ANTHROPIC_API_KEY}",           // ç¯å¢ƒå˜é‡å¼•ç”¨
      "baseUrl": "https://api.anthropic.com",     // API ç«¯ç‚¹
      "timeout": 60000                            // è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
    }
  }
}
```

**æ·»åŠ æ–° Providerï¼š**

```json
{
  "providers": {
    "custom": {
      "apiKey": "${CUSTOM_API_KEY}",
      "baseUrl": "https://custom-api.example.com",
      "timeout": 30000
    }
  }
}
```

#### ui é…ç½®

```json
{
  "ui": {
    "theme": "kanagawa",  // ä¸»é¢˜åç§°
    "mode": "dark"        // äº®è‰²/æš—è‰²æ¨¡å¼
  }
}
```

**å¯ç”¨ä¸»é¢˜ï¼š**
- `kanagawa` - Kanagawaï¼ˆé»˜è®¤ï¼‰
- `github` - GitHub
- `solarized` - Solarized
- `dracula` - Dracula
- `nord` - Nord
- `catppuccin` - Catppuccin

**å¯ç”¨æ¨¡å¼ï¼š**
- `dark` - æš—è‰²æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰
- `light` - äº®è‰²æ¨¡å¼

#### session é…ç½®

```json
{
  "session": {
    "lastSessionId": "1703635200000-abc1234",  // ä¸Šæ¬¡æ‰“å¼€çš„ä¼šè¯
    "autoSave": true,                          // è‡ªåŠ¨ä¿å­˜å¼€å…³
    "saveDebounce": 500                        // é˜²æŠ–å»¶è¿Ÿï¼ˆæ¯«ç§’ï¼‰
  }
}
```

## ğŸ“‚ ä¼šè¯ç®¡ç†

### æŸ¥çœ‹æ‰€æœ‰ä¼šè¯

```bash
# åˆ—å‡ºæ‰€æœ‰ä¼šè¯æ–‡ä»¶
ls -lh ~/.reason-cli/sessions/

# è¾“å‡ºï¼š
# -rw-r--r-- 1 user staff 2.1K Dec 26 10:30 1703635200000-abc1234.json
# -rw-r--r-- 1 user staff 5.3K Dec 26 11:45 1703639100000-def5678.json
```

### æŸ¥çœ‹ä¼šè¯å†…å®¹

```bash
# æŸ¥çœ‹ç‰¹å®šä¼šè¯
cat ~/.reason-cli/sessions/1703635200000-abc1234.json

# è¾“å‡ºï¼š
{
  "session": {
    "id": "1703635200000-abc1234",
    "title": "Session 1",
    "createdAt": 1703635200000,
    "updatedAt": 1703635300000
  },
  "messages": [
    {
      "id": "1703635210000-xyz123",
      "sessionId": "1703635200000-abc1234",
      "role": "user",
      "content": "Hello!",
      "timestamp": 1703635210000
    },
    {
      "id": "1703635220000-abc456",
      "sessionId": "1703635200000-abc1234",
      "role": "assistant",
      "content": "Hi! How can I help you?",
      "timestamp": 1703635220000,
      "metadata": {
        "tokenUsage": {
          "inputTokens": 10,
          "outputTokens": 15,
          "totalTokens": 25
        },
        "model": "claude-sonnet-4"
      }
    }
  ]
}
```

### åˆ é™¤ä¼šè¯

```bash
# âš ï¸ è­¦å‘Šï¼šåˆ é™¤ä¼šè¯ä¸å¯æ¢å¤ï¼

# 1. åˆ—å‡ºæ‰€æœ‰ä¼šè¯
ls ~/.reason-cli/sessions/

# 2. åˆ é™¤ç‰¹å®šä¼šè¯
rm ~/.reason-cli/sessions/1703635200000-abc1234.json

# 3. é‡å¯åº”ç”¨ç”Ÿæ•ˆ
```

### å¯¼å‡ºä¼šè¯

```bash
# å¯¼å‡ºå•ä¸ªä¼šè¯
cp ~/.reason-cli/sessions/1703635200000-abc1234.json ./backup/session.json

# å¯¼å‡ºæ‰€æœ‰ä¼šè¯
cp -r ~/.reason-cli/sessions/ ./backup/sessions/

# å‹ç¼©å¤‡ä»½
tar -czf sessions-backup-$(date +%Y%m%d).tar.gz ~/.reason-cli/sessions/
```

### å¯¼å…¥ä¼šè¯

```bash
# å¯¼å…¥å•ä¸ªä¼šè¯
cp ./backup/session.json ~/.reason-cli/sessions/1703635200000-abc1234.json

# å¯¼å…¥æ‰€æœ‰ä¼šè¯
cp -r ./backup/sessions/* ~/.reason-cli/sessions/

# è§£å‹å¤‡ä»½
tar -xzf sessions-backup-20251226.tar.gz -C ~/
```

## ğŸ”§ é«˜çº§ç”¨æ³•

### è‡ªå®šä¹‰é…ç½®è·¯å¾„

```typescript
// ä¿®æ”¹ util/storage.ts
const STORAGE_DIR = process.env.REASON_CLI_HOME || join(homedir(), '.reason-cli');
```

```bash
# ä½¿ç”¨è‡ªå®šä¹‰è·¯å¾„
export REASON_CLI_HOME=/custom/path
bun run dev
```

### ç¨‹åºåŒ–ä½¿ç”¨

```typescript
import { configManager } from './config/manager';
import { usePersistence } from './hooks/usePersistence';

// åŠ è½½é…ç½®
const config = configManager.loadConfig();
console.log('Current model:', config.model.current);

// æ›´æ–°é…ç½®
configManager.updateConfig({
  model: { current: 'gpt-4o' }
});

// åœ¨ç»„ä»¶ä¸­ä½¿ç”¨
function MyComponent() {
  const { saveCurrentSession, saveConfig } = usePersistence();

  const handleAction = () => {
    // æ‰§è¡Œæ“ä½œ
    doSomething();

    // æ˜¾å¼ä¿å­˜
    saveCurrentSession();
  };
}
```

### æ‰‹åŠ¨è§¦å‘ä¿å­˜

```typescript
import { usePersistence } from './hooks/usePersistence';

function Component() {
  const { saveAll } = usePersistence();

  const handleManualSave = () => {
    // ä¿å­˜æ‰€æœ‰æ•°æ®
    saveAll();
    console.log('All data saved!');
  };
}
```

## ğŸ› ï¸ æ•…éšœæ’æŸ¥

### é…ç½®æ–‡ä»¶æŸå

**ç—‡çŠ¶ï¼š** åº”ç”¨å¯åŠ¨æ—¶ä½¿ç”¨é»˜è®¤é…ç½®ï¼Œä¹‹å‰çš„è®¾ç½®ä¸¢å¤±

**è§£å†³æ–¹æ³•ï¼š**

```bash
# 1. æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦å­˜åœ¨
ls -l ~/.reason-cli/config.json

# 2. éªŒè¯ JSON æ ¼å¼
cat ~/.reason-cli/config.json | jq .

# å¦‚æœæŠ¥é”™ï¼Œè¯´æ˜ JSON æ ¼å¼é”™è¯¯

# 3. å¤‡ä»½æŸåçš„é…ç½®
mv ~/.reason-cli/config.json ~/.reason-cli/config.json.bak

# 4. é‡å¯åº”ç”¨ï¼Œä¼šç”Ÿæˆæ–°çš„é»˜è®¤é…ç½®
bun run dev
```

### ç¯å¢ƒå˜é‡æœªè®¾ç½®

**ç—‡çŠ¶ï¼š** API è°ƒç”¨å¤±è´¥ï¼Œæç¤º API key æ— æ•ˆ

**è§£å†³æ–¹æ³•ï¼š**

```bash
# 1. æ£€æŸ¥ç¯å¢ƒå˜é‡
echo $ANTHROPIC_API_KEY

# 2. å¦‚æœä¸ºç©ºï¼Œè®¾ç½®ç¯å¢ƒå˜é‡
export ANTHROPIC_API_KEY=sk-ant-xxx

# æˆ–è€…åœ¨ .env æ–‡ä»¶ä¸­è®¾ç½®
echo "ANTHROPIC_API_KEY=sk-ant-xxx" >> .env

# 3. é‡å¯åº”ç”¨
bun run dev
```

### ä¼šè¯åŠ è½½å¤±è´¥

**ç—‡çŠ¶ï¼š** å¯åŠ¨æ—¶æç¤ºæ— æ³•åŠ è½½ä¼šè¯

**è§£å†³æ–¹æ³•ï¼š**

```bash
# 1. æ£€æŸ¥ä¼šè¯ç›®å½•
ls -l ~/.reason-cli/sessions/

# 2. éªŒè¯ä¼šè¯æ–‡ä»¶æ ¼å¼
cat ~/.reason-cli/sessions/{sessionId}.json | jq .

# 3. åˆ é™¤æŸåçš„ä¼šè¯
rm ~/.reason-cli/sessions/{sessionId}.json

# 4. é‡å¯åº”ç”¨
bun run dev
```

### æƒé™é—®é¢˜

**ç—‡çŠ¶ï¼š** æ— æ³•å†™å…¥é…ç½®æˆ–ä¼šè¯æ–‡ä»¶

**è§£å†³æ–¹æ³•ï¼š**

```bash
# 1. æ£€æŸ¥ç›®å½•æƒé™
ls -ld ~/.reason-cli

# 2. ä¿®å¤æƒé™
chmod 700 ~/.reason-cli
chmod 600 ~/.reason-cli/config.json
chmod 600 ~/.reason-cli/sessions/*.json

# 3. æ£€æŸ¥æ‰€æœ‰è€…
ls -l ~/.reason-cli
# åº”è¯¥æ˜¯å½“å‰ç”¨æˆ·

# 4. å¦‚æœä¸æ˜¯ï¼Œä¿®æ”¹æ‰€æœ‰è€…
sudo chown -R $USER ~/.reason-cli
```

### æ¸…ç†å’Œé‡ç½®

**å®Œå…¨é‡ç½®åº”ç”¨ï¼š**

```bash
# âš ï¸ è­¦å‘Šï¼šè¿™å°†åˆ é™¤æ‰€æœ‰æ•°æ®ï¼

# 1. å¤‡ä»½æ•°æ®ï¼ˆå¯é€‰ï¼‰
cp -r ~/.reason-cli ~/reason-cli-backup-$(date +%Y%m%d)

# 2. åˆ é™¤æ‰€æœ‰æ•°æ®
rm -rf ~/.reason-cli

# 3. é‡å¯åº”ç”¨ï¼Œä¼šåˆ›å»ºå…¨æ–°çš„é…ç½®
bun run dev
```

**åªé‡ç½®é…ç½®ï¼š**

```bash
# 1. å¤‡ä»½ä¼šè¯
cp -r ~/.reason-cli/sessions ~/sessions-backup

# 2. åˆ é™¤é…ç½®
rm ~/.reason-cli/config.json

# 3. é‡å¯åº”ç”¨
bun run dev

# 4. æ¢å¤ä¼šè¯
cp -r ~/sessions-backup/* ~/.reason-cli/sessions/
```

## ğŸ“Š æ—¥å¿—æŸ¥çœ‹

### åº”ç”¨æ—¥å¿—

```bash
# æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ä½ç½®
# æ—¥å¿—å­˜å‚¨åœ¨ï¼š~/.reason-cli/logs/

# æŸ¥çœ‹æœ€æ–°æ—¥å¿—
tail -f ~/.reason-cli/logs/app.log

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
grep "ERROR" ~/.reason-cli/logs/app.log

# æŸ¥çœ‹ç‰¹å®šæ—¶é—´çš„æ—¥å¿—
grep "2025-12-26" ~/.reason-cli/logs/app.log
```

### è°ƒè¯•æ¨¡å¼

```bash
# è®¾ç½® DEBUG ç¯å¢ƒå˜é‡
export DEBUG=reason-cli:*

# è¿è¡Œåº”ç”¨
bun run dev

# ä¼šè¾“å‡ºè¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯
```

## ğŸ”’ å®‰å…¨æœ€ä½³å®è·µ

### 1. ä¿æŠ¤ API Keys

```bash
# âœ… æ­£ç¡®åšæ³•ï¼šä½¿ç”¨ç¯å¢ƒå˜é‡
export ANTHROPIC_API_KEY=sk-ant-xxx

# âŒ é”™è¯¯åšæ³•ï¼šç¡¬ç¼–ç åœ¨é…ç½®æ–‡ä»¶
{
  "providers": {
    "anthropic": {
      "apiKey": "sk-ant-xxx"  // ä¸è¦è¿™æ ·åšï¼
    }
  }
}
```

### 2. é…ç½®æ–‡ä»¶æƒé™

```bash
# è®¾ç½®ä¸¥æ ¼çš„æ–‡ä»¶æƒé™
chmod 600 ~/.reason-cli/config.json
chmod 700 ~/.reason-cli/sessions/
chmod 600 ~/.reason-cli/sessions/*.json

# ç¡®ä¿åªæœ‰å½“å‰ç”¨æˆ·å¯ä»¥è¯»å†™
ls -l ~/.reason-cli/config.json
# åº”è¯¥æ˜¾ç¤ºï¼š-rw-------
```

### 3. Git å¿½ç•¥

ç¡®ä¿ä¸æäº¤æ•æ„Ÿæ–‡ä»¶ï¼š

```bash
# .gitignore
.env
.reason-cli/
config.json
sessions/
```

### 4. å®šæœŸå¤‡ä»½

```bash
# åˆ›å»ºå¤‡ä»½è„šæœ¬
#!/bin/bash
DATE=$(date +%Y%m%d)
tar -czf ~/backups/reason-cli-$DATE.tar.gz ~/.reason-cli/

# è®¾ç½® cron å®šæ—¶å¤‡ä»½ï¼ˆæ¯å¤©å‡Œæ™¨ 2 ç‚¹ï¼‰
0 2 * * * ~/scripts/backup-reason-cli.sh
```

---

**ç‰ˆæœ¬**: v1.0
**æ›´æ–°æ—¶é—´**: 2025-12-26
