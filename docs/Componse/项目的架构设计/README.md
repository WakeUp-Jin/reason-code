# é¡¹ç›®æ¶æ„è®¾è®¡æ–‡æ¡£

æ¬¢è¿æ¥åˆ°é¡¹ç›®æ¶æ„è®¾è®¡æ–‡æ¡£ï¼è¿™é‡Œè¯¦ç»†ä»‹ç»äº† **Monorepo + Workspace + Core/CLI åˆ†å±‚æ¶æ„** çš„å®Œæ•´è®¾è®¡ã€‚

## ğŸ“š æ–‡æ¡£ç›®å½•

1. **[Monorepo æ¶æ„æ¦‚è¿°](./01-Monorepoæ¶æ„æ¦‚è¿°.md)**
   - ä»€ä¹ˆæ˜¯ Monorepoï¼Ÿ
   - ä¼ ç»Ÿå¤šä»“åº“ vs Monorepo
   - Monorepo çš„ä¼˜åŠ¿
   - Workspace å·¥ä½œæœºåˆ¶
   - ä¾èµ–æå‡ï¼ˆHoistingï¼‰
   - Catalog ç»Ÿä¸€ç‰ˆæœ¬ç®¡ç†
   - ä¸šç•Œæ¡ˆä¾‹

2. **[Core + CLI åˆ†å±‚æ¶æ„](./02-Core+CLIåˆ†å±‚æ¶æ„.md)**
   - æ¶æ„ç†å¿µå’Œè®¾è®¡æ¨¡å¼
   - Core åŒ…è®¾è®¡ï¼ˆæ ¸å¿ƒé€»è¾‘å±‚ï¼‰
   - CLI åŒ…è®¾è®¡ï¼ˆç»ˆç«¯ç•Œé¢å±‚ï¼‰
   - Web åŒ…è®¾è®¡ï¼ˆæœªæ¥æ‰©å±•ï¼‰
   - ä¸ºä»€ä¹ˆè¦åˆ†å±‚ï¼Ÿ
   - æœ€ä½³å®è·µ

3. **[ä¾èµ–ç®¡ç†å’Œæºç æš´éœ²](./03-ä¾èµ–ç®¡ç†å’Œæºç æš´éœ².md)**
   - ä¾èµ–åŒ…å®‰è£…æœºåˆ¶
   - ç¬¦å·é“¾æ¥ï¼ˆSymlinkï¼‰åŸç†
   - æ¨¡å—è§£ææµç¨‹
   - æºç æš´éœ²çš„æ„ä¹‰
   - ä¾èµ–æå‡å’Œç‰ˆæœ¬å†²çªå¤„ç†
   - æ ¹ package.json çš„ä½œç”¨
   - å¼€å‘ vs ç”Ÿäº§ç¯å¢ƒ

4. **[Turbo æ„å»ºç³»ç»Ÿ](./04-Turboæ„å»ºç³»ç»Ÿ.md)**
   - ä»€ä¹ˆæ˜¯ Turboï¼Ÿ
   - ä¸ºä»€ä¹ˆéœ€è¦ Turboï¼Ÿ
   - Turbo é…ç½®è¯¦è§£
   - å®é™…ä½¿ç”¨åœºæ™¯
   - ç¼“å­˜æœºåˆ¶
   - é«˜çº§åŠŸèƒ½ï¼ˆè¿œç¨‹ç¼“å­˜ã€è¿‡æ»¤å™¨ç­‰ï¼‰
   - æ€§èƒ½å¯¹æ¯”

## ğŸ¯ å¿«é€Ÿç†è§£æ¶æ„

### æ•´ä½“æ¶æ„å›¾

```
my-agent-project/
â”œâ”€â”€ package.json              # æ ¹é…ç½®ï¼ˆå£°æ˜ workspacesï¼‰
â”œâ”€â”€ turbo.json                # Turbo æ„å»ºé…ç½®
â”œâ”€â”€ node_modules/             # å…±äº«ä¾èµ– + ç¬¦å·é“¾æ¥
â”‚   â”œâ”€â”€ @my-agent/
â”‚   â”‚   â”œâ”€â”€ core -> ../../packages/core    # é“¾æ¥åˆ°æºç 
â”‚   â”‚   â””â”€â”€ cli -> ../../packages/cli      # é“¾æ¥åˆ°æºç 
â”‚   â”œâ”€â”€ typescript/           # å…±äº«ä¾èµ–
â”‚   â””â”€â”€ zod/                  # å…±äº«ä¾èµ–
â””â”€â”€ packages/
    â”œâ”€â”€ core/                 # ğŸ§  æ ¸å¿ƒé€»è¾‘ï¼ˆç¨³å®šï¼‰
    â”‚   â”œâ”€â”€ src/
    â”‚   â”‚   â”œâ”€â”€ agent.ts
    â”‚   â”‚   â”œâ”€â”€ llm.ts
    â”‚   â”‚   â””â”€â”€ tools.ts
    â”‚   â””â”€â”€ package.json
    â”œâ”€â”€ cli/                  # ğŸ’» ç»ˆç«¯ç•Œé¢
    â”‚   â”œâ”€â”€ src/
    â”‚   â”‚   â””â”€â”€ index.ts
    â”‚   â””â”€â”€ package.json
    â””â”€â”€ web/                  # ğŸŒ Web ç•Œé¢ï¼ˆæœªæ¥ï¼‰
        â”œâ”€â”€ src/
        â””â”€â”€ package.json
```

### ä¾èµ–å…³ç³»

```
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚    core     â”‚  â—„â”€â”€â”€ æ ¸å¿ƒé€»è¾‘ï¼ˆæ—  UI ä¾èµ–ï¼‰
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                â”‚ workspace:*
                â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚           â”‚           â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”  â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â–¼â”€â”€â”€â”€â”
â”‚  cli   â”‚  â”‚  web   â”‚  â”‚desktopâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒæœºåˆ¶

1. **Workspaces** - å¤šåŒ…ç®¡ç†
   ```json
   "workspaces": { "packages": ["packages/*"] }
   ```

2. **ç¬¦å·é“¾æ¥** - Core æºç æš´éœ²
   ```
   node_modules/@my-agent/core -> packages/core
   ```

3. **Catalog** - ç»Ÿä¸€ç‰ˆæœ¬
   ```json
   "catalog": { "typescript": "5.8.2" }
   ```

4. **Turbo** - æ™ºèƒ½æ„å»º
   ```bash
   bun turbo build  # è‡ªåŠ¨åˆ†æä¾èµ–ï¼Œæ™ºèƒ½ç¼“å­˜
   ```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. åˆ›å»ºé¡¹ç›®

```bash
mkdir my-agent-project && cd my-agent-project
```

### 2. æ ¹ package.json

```json
{
  "name": "my-agent-project",
  "private": true,
  "workspaces": {
    "packages": ["packages/*"],
    "catalog": {
      "typescript": "5.8.2",
      "zod": "4.1.8"
    }
  },
  "scripts": {
    "dev": "turbo dev",
    "build": "turbo build",
    "typecheck": "turbo typecheck"
  },
  "devDependencies": {
    "turbo": "2.5.6",
    "typescript": "catalog:"
  }
}
```

### 3. åˆ›å»º Core åŒ…

```bash
mkdir -p packages/core/src
```

**packages/core/package.json:**
```json
{
  "name": "@my-agent/core",
  "version": "1.0.0",
  "exports": {
    ".": "./src/index.ts"
  },
  "dependencies": {
    "zod": "catalog:"
  }
}
```

**packages/core/src/index.ts:**
```typescript
export class Agent {
  run(input: string): Promise<string> {
    return Promise.resolve(`Response: ${input}`)
  }
}
```

### 4. åˆ›å»º CLI åŒ…

```bash
mkdir -p packages/cli/src
```

**packages/cli/package.json:**
```json
{
  "name": "@my-agent/cli",
  "version": "1.0.0",
  "bin": {
    "my-agent": "./dist/index.js"
  },
  "dependencies": {
    "@my-agent/core": "workspace:*"
  }
}
```

**packages/cli/src/index.ts:**
```typescript
#!/usr/bin/env node
import { Agent } from '@my-agent/core'

const agent = new Agent()
const response = await agent.run('Hello')
console.log(response)
```

### 5. å®‰è£…ä¾èµ–

```bash
bun install
```

### 6. è¿è¡Œ

```bash
bun run --cwd packages/cli src/index.ts
# è¾“å‡ºï¼šResponse: Hello
```

## ğŸ’¡ æ ¸å¿ƒæ¦‚å¿µ

| æ¦‚å¿µ | è¯´æ˜ | ä¼˜åŠ¿ |
|------|------|------|
| **Monorepo** | å¤šä¸ªåŒ…åœ¨ä¸€ä¸ªä»“åº“ | ä»£ç å…±äº«ã€åŸå­åŒ–æäº¤ |
| **Workspaces** | å¤šåŒ…ç®¡ç†æœºåˆ¶ | è‡ªåŠ¨ç¬¦å·é“¾æ¥ã€ä¾èµ–æå‡ |
| **Core/CLI åˆ†å±‚** | é€»è¾‘ä¸ç•Œé¢åˆ†ç¦» | å¤šå¹³å°å¤ç”¨ã€æ˜“äºæµ‹è¯• |
| **æºç æš´éœ²** | å¼€å‘æ—¶ä½¿ç”¨ .ts æºç  | çƒ­æ›´æ–°ã€å®Œæ•´ç±»å‹ |
| **Catalog** | ç»Ÿä¸€ç‰ˆæœ¬ç®¡ç† | é¿å…ç‰ˆæœ¬å†²çª |
| **Turbo** | æ™ºèƒ½æ„å»ºç³»ç»Ÿ | ç¼“å­˜ã€å¹¶è¡Œã€å¢é‡æ„å»º |

## ğŸ“– é˜…è¯»å»ºè®®

### æ–°æ‰‹è·¯çº¿

1. å…ˆè¯» **[Monorepo æ¶æ„æ¦‚è¿°](./01-Monorepoæ¶æ„æ¦‚è¿°.md)** - ç†è§£æ•´ä½“æ¶æ„
2. å†è¯» **[Core + CLI åˆ†å±‚æ¶æ„](./02-Core+CLIåˆ†å±‚æ¶æ„.md)** - ç†è§£å¦‚ä½•è®¾è®¡åŒ…
3. ç„¶åè¯» **[ä¾èµ–ç®¡ç†å’Œæºç æš´éœ²](./03-ä¾èµ–ç®¡ç†å’Œæºç æš´éœ².md)** - ç†è§£å·¥ä½œåŸç†
4. æœ€åè¯» **[Turbo æ„å»ºç³»ç»Ÿ](./04-Turboæ„å»ºç³»ç»Ÿ.md)** - ç†è§£å¦‚ä½•æ„å»º

### è¿›é˜¶è·¯çº¿

1. **æ¶æ„è®¾è®¡** â†’ é˜…è¯» 02-Core+CLI åˆ†å±‚æ¶æ„
2. **æ€§èƒ½ä¼˜åŒ–** â†’ é˜…è¯» 04-Turbo æ„å»ºç³»ç»Ÿ
3. **é—®é¢˜æ’æŸ¥** â†’ é˜…è¯» 03-ä¾èµ–ç®¡ç†å’Œæºç æš´éœ²

## ğŸ”¥ å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆä½¿ç”¨ Monorepoï¼Ÿ

**A:** ä¾¿äºä»£ç å…±äº«ã€ç»Ÿä¸€å·¥å…·é“¾ã€åŸå­åŒ–æäº¤ï¼Œç‰¹åˆ«é€‚åˆå¤šå¹³å°åº”ç”¨ï¼ˆCLI + Web + Desktopï¼‰ã€‚

### Q2: Core å’Œ CLI ä¸ºä»€ä¹ˆè¦åˆ†ç¦»ï¼Ÿ

**A:** Core æ˜¯çº¯é€»è¾‘ï¼Œä¸ä¾èµ– UIï¼›CLI/Web/Desktop æ˜¯ä¸åŒçš„ç•Œé¢ã€‚è¿™æ · Core ä¿æŒç¨³å®šï¼Œç•Œé¢å¯ä»¥çµæ´»è¿­ä»£ã€‚

### Q3: CLI å¦‚ä½•ä½¿ç”¨ Core çš„æºç ï¼Ÿ

**A:** é€šè¿‡ `workspace:*` + `exports` + ç¬¦å·é“¾æ¥ï¼ŒCLI ç›´æ¥å¯¼å…¥ Core çš„ `.ts` æºç æ–‡ä»¶ã€‚

### Q4: ä¸ºä»€ä¹ˆéœ€è¦ Turboï¼Ÿ

**A:** Turbo è‡ªåŠ¨åˆ†æä¾èµ–å…³ç³»ï¼Œæ™ºèƒ½ç¼“å­˜æ„å»ºç»“æœï¼Œå¹¶è¡Œæ‰§è¡Œä»»åŠ¡ï¼Œå¤§å¹…æå‡æ„å»ºé€Ÿåº¦ã€‚

### Q5: ä¾èµ–åŒ…è£…åœ¨å“ªé‡Œï¼Ÿ

**A:** å¤§éƒ¨åˆ†ä¾èµ–é€šè¿‡"ä¾èµ–æå‡"å®‰è£…åœ¨æ ¹ `node_modules`ï¼Œé¿å…é‡å¤å®‰è£…ã€‚

## ğŸ“ ä¸šç•Œæ¡ˆä¾‹

ä½¿ç”¨ç±»ä¼¼æ¶æ„çš„çŸ¥åé¡¹ç›®ï¼š

- **Vercel** - Next.js åŠå…¶ç”Ÿæ€
- **Microsoft** - TypeScriptã€VS Code
- **Facebook** - Reactã€Jestã€Metro
- **Google** - Angularã€Bazel
- **Nx** - ä¼ä¸šçº§ Monorepo å·¥å…·

## ğŸ“ æ€»ç»“

è¿™å¥—æ¶æ„ç»“åˆäº†ï¼š
- âœ… **Monorepo** - ç»Ÿä¸€ç®¡ç†
- âœ… **Workspaces** - ä¾èµ–ç®¡ç†
- âœ… **åˆ†å±‚è®¾è®¡** - é€»è¾‘ä¸ç•Œé¢åˆ†ç¦»
- âœ… **æºç æš´éœ²** - å¼€å‘ä½“éªŒ
- âœ… **Turbo** - æ„å»ºä¼˜åŒ–

**é€‚ç”¨äºéœ€è¦å¤šå¹³å°æ”¯æŒã€é¢‘ç¹è¿­ä»£ã€å›¢é˜Ÿåä½œçš„ç°ä»£åº”ç”¨å¼€å‘ï¼** ğŸš€

## ğŸ“¬ åé¦ˆ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿æå‡ºï¼

---

**æœ€åæ›´æ–°ï¼š** 2025-12-23
